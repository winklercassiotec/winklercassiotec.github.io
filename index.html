<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cássio Winkler</title>

<meta name="description" content="Cássio Winkler">
<meta name="keywords" content="Cássio Winkler">
<meta name="robots" content="index, follow">

<meta property="og:title" content="Cássio Winkler">
<meta property="og:description" content="Cássio Winkler">
<meta property="og:type" content="website">

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #ECE5DD;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.chat-container {
    width: 100%;
    max-width: 400px;
    height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
    background: #FFF;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.chat-header {
    background: #075E54;
    color: white;
    padding: 15px;
    font-size: 1.1rem;
    text-align: center;
    font-weight: bold;
}

.chat-body {
    flex: 1;
    padding: 15px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.message {
    max-width: 80%;
    margin-bottom: 10px;
    padding: 10px 15px;
    border-radius: 20px;
    font-size: 0.95rem;
    line-height: 1.3;
    word-wrap: break-word;
}

.bot {
    background: #DCF8C6;
    align-self: flex-start;
}

.user {
    background: #34B7F1;
    color: white;
    align-self: flex-end;
}

.input-container {
    display: flex;
    border-top: 1px solid #ddd;
    padding: 10px;
    background: #f0f0f0;
}

.input-container input {
    flex: 1;
    padding: 10px 15px;
    border: none;
    border-radius: 25px;
    outline: none;
    font-size: 1rem;
}

.input-container button {
    margin-left: 10px;
    padding: 10px 20px;
    background: #075E54;
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1rem;
}

.error-message {
    color: #FF3B30;
    font-size: 0.85rem;
    margin-top: 5px;
}

@media (max-width: 500px) {
    .chat-container {
        height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
    }
}
</style>
</head>
<body>
<div class="chat-container">
    <div class="chat-header">Entre em contato:</div>
    <div class="chat-body" id="chatBody">
        <div class="message bot" id="msg0">
            Olá! Seja bem-vindo ao meu site.<br>Para iniciarmos, por favor, digite seu nome completo:
        </div>
    </div>
    <div class="input-container">
        <input type="text" id="userInput" placeholder="Digite aqui..." />
        <button id="sendBtn">Enviar</button>
    </div>
    <div id="error" class="error-message"></div>
</div>

<script>
const chatBody = document.getElementById('chatBody');
const userInput = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');
const errorDiv = document.getElementById('error');

let step = 0;
const userData = {};

const encryptedNumber = "KzU1NDI5OTgzNTQ5Nw==";

function decryptNumber(enc){ return atob(enc); }


function appendMessage(text, sender){
    const msgDiv = document.createElement('div');
    msgDiv.classList.add('message', sender);
    msgDiv.textContent = text;
    chatBody.appendChild(msgDiv);
    chatBody.scrollTop = chatBody.scrollHeight;
}

function formatPhone(value){
    value = value.replace(/\D/g,'');
    if(value.length > 10){
        return value.replace(/^(\d{2})(\d{5})(\d{4}).*/,"($1) $2-$3");
    } else if(value.length > 5){
        return value.replace(/^(\d{2})(\d{4})(\d{0,4}).*/,"($1) $2-$3");
    } else if(value.length > 2){
        return value.replace(/^(\d{2})(\d{0,5})/, "($1) $2");
    } else {
        return value.replace(/^(\d*)/, "($1");
    }
}

function validateEmail(email){
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function clearError(){ errorDiv.textContent = ''; }

function nextStep() {
    let value = userInput.value.trim();
    clearError();
    if(!value) return;

    if(step === 1){
        value = formatPhone(value);
        if(value.replace(/\D/g,'').length < 10){ 
            errorDiv.textContent = "Digite um telefone válido."; 
            return; 
        }
    }

    if(step === 2){
        if(!validateEmail(value)){ 
            errorDiv.textContent = "Digite um e-mail válido."; 
            return; 
        }
    }

    appendMessage(value, 'user');
    userInput.value = '';

    switch(step){
        case 0:
            userData.name = value;
            appendMessage("Perfeito, " + value + ". Agora, por favor, informe seu número de telefone/celular:", 'bot');
            step++; break;
        case 1:
            userData.phone = value;
            appendMessage("Ótimo! Agora, qual o seu melhor e-mail para contato?", 'bot');
            step++; break;
        case 2:
            userData.email = value;
            appendMessage("Excelente! Por fim, me conte como posso ajudar? (descreva brevemente seu motivo de contato):", 'bot');
            step++; break;
        case 3:
            userData.message = value;
            appendMessage("Tudo pronto! Redirecionando você para o WhatsApp...", 'bot');
            userInput.disabled = true;
            sendBtn.disabled = true;

            // Decodifica número e gera link seguro
            const number = decryptNumber(encryptedNumber);
            const waLink = `https://wa.me/${number.replace(/\D/g,'')}?text=${encodeURIComponent(
                "*Nome:* " + userData.name + "\n" +
                "*Telefone:* " + userData.phone + "\n" +
                "*E-mail:* " + userData.email + "\n" +
                "*Mensagem:* " + userData.message
            )}`;
            setTimeout(()=> window.open(waLink, "_blank"), 800);
            break;
    }
}

userInput.addEventListener("input", function(){ if(step===1) this.value=formatPhone(this.value); });
userInput.addEventListener("keypress", function(e){ if(e.key==="Enter") nextStep(); });
sendBtn.addEventListener("click", nextStep);

document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
    if(e.key==="F12" || 
       (e.ctrlKey && e.shiftKey && ["I","J","C"].includes(e.key.toUpperCase())) ||
       (e.ctrlKey && e.key.toUpperCase()==="U")) e.preventDefault();
});
</script>
</body>
</html>
